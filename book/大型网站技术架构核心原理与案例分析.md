## 大型网站技术架构核心原理与案例分析

![封面图片](https://img3.doubanio.com/lpic/s27250675.jpg)

作者:李智慧

出版社:电子工业出版社

----- 

### 大型网站系统的特点

1. 高并发 大流量
2. 高可用
3. 海量数据
4. 用户分布广泛,网络情况复杂
5. 安全环境恶劣
6. 需求快速变更,发布频繁
7. 渐进式发展


### 大型网站架构演化发展历程
---

1. 初始阶段:应用程序,数据库\文件资源在同一台服务器
2. 应用服务器和数据服务分离
3. 使用缓存改善网站性能(本地缓存和远程缓存)
4. 使用应用服务器集群改善网站的并发处理能力
5. 数据库读写分离(二八定律)
6. 使用反向代理和CDN加速网站响应
7. 使用分布式文件系统和分布式数据库系统(将不同业务的数据库部署在不同的物理服务器上)
8. 使用NoSQL和搜索引擎
9. 业务拆分(如电子商务网站的首页,商铺,订单,买家等拆分到不同的产品线)
10. 分布式服务(所有业务通过分布式服务调用公用业务服务完成具体业务操作)

### 大型网站架构模式
---
1. 分层(横向切割:应用层,服务层,数据层)
2. 分割(垂直切割:购物,论坛,搜索,广告等,各自独立部署,由不同的团队负责)
3. 分布式(分布式应用和服务,分布式静态资源,分布式数据和存储,分布式计算)
4. 集群(利用负责均衡,提高系统的可用性)
5. 缓存(CDN,反向代理,本地缓存,分布式缓存)
6. 异步(生产者-消费者模式,消息队列解耦模块,提高系统可用性,加快网站响应速度,消除并发访问高峰)
7. 冗余(服务器预备,数据库备份)
8. 自动化(自动化发布,测试,部署,监控,失效转移,服务降级,资源分配)
9. 安全(验证码,XSS,SQL注入,编码转换)


### 大型网站核心架构要素
---

> 性能

#### 性能测试指标:

- 响应时间:发出请求到收到响应数据所需要的时间
- 并发数:系统同时处理请求的数量
- 吞吐量:单位时间内系统处理的请求数量,体现系统的整体处理能力(TPS每秒事务数,HPS每秒HTTP请求数,QPS每秒查询数) 
- 系能计数器:监控系统负载,对象与线程数,CPU使用,内存使用,磁盘与网络I/O等指标

#### 性能分析

检查各个环节的日志,分析哪个环节响应时间不合理,检查监控数据,分析影响性能的主要因素是内存、磁盘、网络还是CPU,是代码问题还是架构设计部合理,或者系统资源确实不足.

#### 优化一:WEB前端系能优化

- 减少HTTP请求数(合并CSS,JS,图片)
- 使用浏览器缓存(Cache-Control、Expires)
- 启用压缩(gzip压缩文本效率可达到80%以上)
- CSS放顶部,JS放尾部
- 减少COOKIE传输
- CDN加速
- 反向代理


#### 优化二:应用服务器性能优化

- 分布式缓存(一种以JBoss Cache为代表的同步更新的分布式缓存、另一种以Memcached为代表的互不通信的分布式缓存)
- 异步操作(任何可以晚点做的事情都应该晚点再做)
- 使用集群(使用负载均衡对付高并发的访问)
- 代码优化(多线程,资源复用、连接池、对象池、单例,数据结构,垃圾回收)


#### 优化三:存储性能优化

- 机械硬盘 vs. 固态硬盘
- B+树 vs. LSM树
- RAID vs. HDFS

> 可用性



> 伸缩性



> 扩展性



> 安全性

