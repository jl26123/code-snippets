## 白帽子讲WEB安全.md

![封面图片](http://img3.douban.com/lpic/s8977570.jpg)

作者:吴瀚清

出版社:电子工业出版社

----- 

### 一 我的安全世界观

安全问题的本质是信任的问题

安全是个一个持续的过程

安全三要素:机密性(Confidentiality) 完整性(Integrity) 可用性(Availability)

安全评估流程:

1. 资产登记划分
2. 威胁分析
3. 风险分析
4. 确认解决方案

**互联网安全的核心问题,是数据安全的问题**

白帽子兵法

- 黑名单与白名单策略
- 最小权限原则
- 纵深防御原则
- 数据与代码分离原则
- 不可预测性原则


### 二 浏览器安全

#### 2.1 同源策略

影响"源"因素:host,子域名,端口,协议

在浏览器中,`<script>`,`<img>`,`<iframe>`,`<link>`等标签都可以蛞蝓加载资源,而不受同源策略的限制

Flash主要通过目标网站提供的`crossdomain.xml`文件判断是否允许当前"源"的Flash跨域访问目标资源

因为Javascript无法控制HTTP头,可以通过目标域返回的HTTP头来授权是否允许蛞蝓访问


#### 2.2 浏览器沙箱

浏览器多进程架构将各个功能模块分开,各个浏览器实例分开,当一个进程崩溃时,不会影响其他的进程



#### 2.3 恶意网址拦截

浏览器周期性的从服务器短获取一份最新的恶意网址黑名单


### 三 跨站脚本攻击(XSS)

#### 3.1 XSS简介

- 反射型XSS(非持久化存储):只是简单的把用户输入的数据"反射"给浏览器
- 存储型XSS(持久化存储)
- DOM Based XSS


#### 3.2 XSS攻击进阶

XSS Payload实际上就是javascript脚本,所以任何javascript脚本能实现的功能,XSS Payload都能做到

常见攻击方法:

- 读取cookie对象,发起"Cookie 劫持",但是如果设置了`HttpOnly`或者绑定了客户端IP则cookie劫持失效
- 模拟GET,POST请求,操作用户的浏览器
- 伪造页面内容,比如弹出框提示修改密码
- 识别用户的浏览器和操作系统信息,从而可以跟精准的实施攻击
- 识别用户安装的软件,通过安装的软件漏洞攻击
- CSS History Hack,其原理是利用style的visited属性判断是否已经访问过该网站
- 获取用户的真实IP,Javascript本身并没有获取本地IP的能力,需要借助第三方软件来完成,如调用Java Applet

XSS攻击技巧

- 利用字符编码
- 绕过长度限制
- 使用base标签


#### 3.3 XSS防御

- HttpOnly
- 输入检查
- 输出检查


### 跨站请求伪造

